<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link href="/css/output.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <%- include('../partials/navbar') %>
  
  <section class="py-16 bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4">
      <div class="max-w-2xl mx-auto">
        <div class="card p-8">
          <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">إنشاء حساب جديد</h2>
          
          <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
            <div class="alert alert-error mb-6">
              <% errors.forEach(error => { %>
                <p><i class="fas fa-exclamation-circle ml-2"></i><%= error.msg %></p>
              <% }); %>
            </div>
          <% } %>
          
          <form action="/auth/register" method="POST">
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2" for="name">
                <i class="fas fa-user ml-2"></i>
                الاسم الكامل
              </label>
              <input 
                type="text" 
                id="name" 
                name="name" 
                class="input-field"
                value="<%= typeof name !== 'undefined' ? name : '' %>"
                required
              >
            </div>
            
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2" for="email">
                <i class="fas fa-envelope ml-2"></i>
                البريد الإلكتروني
              </label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="input-field"
                value="<%= typeof email !== 'undefined' ? email : '' %>"
                required
              >
            </div>
            
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2" for="role">
                <i class="fas fa-user-tag ml-2"></i>
                نوع الحساب
              </label>
              <select id="role" name="role" class="input-field" required onchange="toggleRoleFields()">
                <option value="">اختر نوع الحساب</option>
                <option value="student" <%= typeof role !== 'undefined' && role === 'student' ? 'selected' : '' %>>تلميذ</option>
                <option value="teacher" <%= typeof role !== 'undefined' && role === 'teacher' ? 'selected' : '' %>>مدرس</option>
                <option value="parent" <%= typeof role !== 'undefined' && role === 'parent' ? 'selected' : '' %>>ولي</option>
              </select>
            </div>
            
            <!-- حقول خاصة بالتلميذ -->
            <div id="student-fields" class="hidden">
              <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2" for="classLevel">
                  <i class="fas fa-graduation-cap ml-2"></i>
                  القسم (المستوى الدراسي)
                </label>
                <select id="classLevel" name="classLevel" class="input-field">
                  <option value="">اختر القسم</option>
                  <option value="7 أساسي">7 أساسي</option>
                  <option value="8 أساسي">8 أساسي</option>
                  <option value="9 أساسي">9 أساسي</option>
                </select>
              </div>
              
              <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2" for="classNumber">
                  <i class="fas fa-users ml-2"></i>
                  رقم الصف
                </label>
                <select id="classNumber" name="classNumber" class="input-field">
                  <option value="">اختر رقم الصف</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                </select>
              </div>
            </div>
            
            <!-- حقول خاصة بالمدرس -->
            <div id="teacher-fields" class="hidden">
              <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2" for="subject">
                  <i class="fas fa-book ml-2"></i>
                  المادة
                </label>
                <input 
                  type="text" 
                  id="subject" 
                  name="subject" 
                  class="input-field"
                  placeholder="مثال: الرياضيات"
                >
              </div>
            </div>
            
            <!-- حقول خاصة بولي الأمر -->
            <div id="parent-fields" class="hidden">
              <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2" for="childFirstName">
                  <i class="fas fa-user-graduate ml-2"></i>
                  الاسم الأول للابن
                </label>
                <input 
                  type="text" 
                  id="childFirstName" 
                  name="childFirstName" 
                  class="input-field"
                  placeholder="الاسم الأول"
                >
                <p class="text-xs text-gray-500 mt-1">يجب أن يطابق الاسم المسجل في النظام</p>
              </div>
              
              <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2" for="childLastName">
                  <i class="fas fa-user-graduate ml-2"></i>
                  اللقب للابن
                </label>
                <input 
                  type="text" 
                  id="childLastName" 
                  name="childLastName" 
                  class="input-field"
                  placeholder="اللقب"
                >
                <p class="text-xs text-gray-500 mt-1">يجب أن يطابق اللقب المسجل في النظام</p>
              </div>
            </div>
            
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2" for="password">
                <i class="fas fa-lock ml-2"></i>
                كلمة المرور
              </label>
              <input 
                type="password" 
                id="password" 
                name="password" 
                class="input-field"
                required
                minlength="6"
              >
            </div>
            
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2" for="password2">
                <i class="fas fa-lock ml-2"></i>
                تأكيد كلمة المرور
              </label>
              <input 
                type="password" 
                id="password2" 
                name="password2" 
                class="input-field"
                required
                minlength="6"
              >
            </div>
            
            <button type="submit" class="btn-primary w-full mb-4">
              <i class="fas fa-user-plus ml-2"></i>
              إنشاء حساب
            </button>
            
            <p class="text-center text-gray-600">
              لديك حساب بالفعل؟ 
              <a href="/auth/login" class="text-primary-600 hover:text-primary-800 font-semibold">
                سجل دخولك
              </a>
            </p>
          </form>
        </div>
      </div>
    </div>
  </section>
  
  <%- include('../partials/footer') %>
  
  <script>
    function toggleRoleFields() {
      const role = document.getElementById('role').value;
      const studentFields = document.getElementById('student-fields');
      const teacherFields = document.getElementById('teacher-fields');
      const parentFields = document.getElementById('parent-fields');
      
      studentFields.classList.add('hidden');
      teacherFields.classList.add('hidden');
      parentFields.classList.add('hidden');
      
      if (role === 'student') {
        studentFields.classList.remove('hidden');
      } else if (role === 'teacher') {
        teacherFields.classList.remove('hidden');
      } else if (role === 'parent') {
        parentFields.classList.remove('hidden');
      }
    }
    
    // التحقق من القيمة الأولية
    window.onload = toggleRoleFields;
  </script>
</body>
</html>
